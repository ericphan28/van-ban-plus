# HÆ°á»›ng dáº«n sá»­ dá»¥ng tÃ­nh nÄƒng CÄ‚N Cá»¨ (Based On)

## Tá»•ng quan

Dá»±a trÃªn phÃ¢n tÃ­ch cÃ¡c vÄƒn báº£n máº«u thá»±c táº¿ (Luáº­t, Nghá»‹ Ä‘á»‹nh, Quyáº¿t Ä‘á»‹nh, ThÃ´ng bÃ¡o), chÃºng tÃ´i Ä‘Ã£ bá»• sung pháº§n **CÄ‚N Cá»¨** - má»™t pháº§n báº¯t buá»™c vÃ  quan trá»ng trong vÄƒn báº£n hÃ nh chÃ­nh nhÃ  nÆ°á»›c Viá»‡t Nam.

## Cáº¥u trÃºc vÄƒn báº£n hÃ nh chÃ­nh VN (theo ThÃ´ng tÆ° 01/2011/TT-BNV)

1. **Header**: TÃªn cÆ¡ quan cáº¥p trÃªn + TÃªn Ä‘Æ¡n vá»‹
2. **Sá»‘ vÄƒn báº£n**: Sá»‘: XXX/YYY-ZZZ
3. **NgÃ y thÃ¡ng**: NgÃ y ... thÃ¡ng ... nÄƒm ...
4. **Loáº¡i vÄƒn báº£n**: QUYáº¾T Äá»ŠNH, NGHá»Š Äá»ŠNH, THÃ”NG BÃO, v.v.
5. **TiÃªu Ä‘á»**: Vá» viá»‡c ABC
6. **ğŸ†• CÄ‚N Cá»¨**: Liá»‡t kÃª cÃ¡c cÄƒn cá»© phÃ¡p lÃ½
7. **Ná»™i dung**: Ná»™i dung chi tiáº¿t vÄƒn báº£n
8. **NÆ¡i nháº­n/Chá»¯ kÃ½**: Chá»©c danh, Há» tÃªn

## TÃ­nh nÄƒng má»›i

### 1. Nháº­p CÄƒn cá»© phÃ¡p lÃ½

Khi táº¡o/sá»­a vÄƒn báº£n, báº¡n sáº½ tháº¥y trÆ°á»ng **"CÄƒn cá»© phÃ¡p lÃ½"** má»›i:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CÄƒn cá»© phÃ¡p lÃ½ (má»—i dÃ²ng 1 cÄƒn cá»©)            â”‚
â”‚                                                â”‚
â”‚ CÄƒn cá»© Luáº­t Tá»• chá»©c chÃ­nh quyá»n Ä‘á»‹a phÆ°Æ¡ng... â”‚
â”‚ CÄƒn cá»© Nghá»‹ Ä‘á»‹nh sá»‘ 66/NQ-CP...               â”‚
â”‚ Theo Ä‘á» nghá»‹ cá»§a TrÆ°á»Ÿng phÃ²ng...              â”‚
â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CÃ¡ch nháº­p:**
- Má»—i dÃ²ng = 1 cÄƒn cá»©
- Báº¯t Ä‘áº§u báº±ng "CÄƒn cá»©" hoáº·c "Theo" (náº¿u chÆ°a cÃ³, há»‡ thá»‘ng sáº½ tá»± thÃªm "CÄƒn cá»©" khi xuáº¥t Word)
- Káº¿t thÃºc báº±ng dáº¥u cháº¥m pháº©y (;)

**VÃ­ dá»¥:**
```
CÄƒn cá»© Luáº­t Tá»• chá»©c chÃ­nh quyá»n Ä‘á»‹a phÆ°Æ¡ng ngÃ y 19/6/2015;
CÄƒn cá»© Nghá»‹ Ä‘á»‹nh sá»‘ 66/NQ-CP ngÃ y 26/3/2025;
Theo Ä‘á» nghá»‹ cá»§a TrÆ°á»Ÿng phÃ²ng TÃ i chÃ­nh ngÃ y 15/3/2025;
```

### 2. Xuáº¥t Word vá»›i CÄƒn cá»©

Khi xuáº¥t vÄƒn báº£n ra Word (Ä‘Æ¡n láº» hoáº·c hÃ ng loáº¡t), pháº§n **CÄ‚N Cá»¨** sáº½ Ä‘Æ°á»£c render theo Ä‘Ãºng Ä‘á»‹nh dáº¡ng chuáº©n:

```
                    QUYáº¾T Äá»ŠNH
                 Vá» viá»‡c ABC XYZ
                ----------------------

CÄƒn cá»© Luáº­t Tá»• chá»©c chÃ­nh quyá»n Ä‘á»‹a phÆ°Æ¡ng ngÃ y 19/6/2015;
CÄƒn cá»© Nghá»‹ Ä‘á»‹nh sá»‘ 66/NQ-CP ngÃ y 26/3/2025;
Theo Ä‘á» nghá»‹ cá»§a TrÆ°á»Ÿng phÃ²ng TÃ i chÃ­nh ngÃ y 15/3/2025;

    Ná»™i dung vÄƒn báº£n báº¯t Ä‘áº§u tá»« Ä‘Ã¢y...
```

**Äá»‹nh dáº¡ng:**
- Font: Times New Roman 14pt
- CÄƒn lá»: TrÃ¡i (khÃ´ng thá»¥t Ä‘áº§u dÃ²ng)
- Line spacing: 1.3 (theo chuáº©n ThÃ´ng tÆ° 01/2011)
- Khoáº£ng cÃ¡ch: 1 dÃ²ng trá»‘ng trÆ°á»›c vÃ  sau pháº§n cÄƒn cá»©

### 3. Bulk Export (Xuáº¥t hÃ ng loáº¡t)

Pháº§n cÄƒn cá»© cÅ©ng Ä‘Æ°á»£c bao gá»“m khi xuáº¥t nhiá»u vÄƒn báº£n vÃ o má»™t file Word:
- Má»—i vÄƒn báº£n cÃ³ pháº§n cÄƒn cá»© riÃªng
- Ngáº¯t trang giá»¯a cÃ¡c vÄƒn báº£n
- Äá»‹nh dáº¡ng nháº¥t quÃ¡n

## Cáº¥u trÃºc ká»¹ thuáº­t

### 1. Model (Document.cs)

```csharp
public class Document
{
    // ... cÃ¡c field khÃ¡c ...
    
    /// <summary>
    /// CÄƒn cá»© phÃ¡p lÃ½ - Máº£ng cÃ¡c cÄƒn cá»© (má»—i pháº§n tá»­ = 1 dÃ²ng)
    /// </summary>
    public string[] BasedOn { get; set; } = Array.Empty<string>();
}
```

### 2. UI (DocumentEditDialog.xaml)

```xml
<!-- CÄ‚N Cá»¨ - Pháº§n quan trá»ng trong vÄƒn báº£n hÃ nh chÃ­nh VN -->
<TextBox x:Name="txtBasedOn" 
         materialDesign:HintAssist.Hint="CÄƒn cá»© phÃ¡p lÃ½..."
         AcceptsReturn="True"
         TextWrapping="Wrap"
         MinHeight="100"/>
```

### 3. Code-behind (DocumentEditDialog.xaml.cs)

**Load:**
```csharp
txtBasedOn.Text = string.Join(Environment.NewLine, Document.BasedOn);
```

**Save:**
```csharp
Document.BasedOn = txtBasedOn.Text
    .Split(new[] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries)
    .Select(s => s.Trim())
    .Where(s => !string.IsNullOrWhiteSpace(s))
    .ToArray();
```

### 4. Word Export (WordExportService.cs)

```csharp
private void AddBasedOn(Body body, DocModel document)
{
    foreach (var basedOnItem in document.BasedOn)
    {
        // Äáº£m báº£o text báº¯t Ä‘áº§u báº±ng "CÄƒn cá»©" hoáº·c "Theo"
        var text = basedOnItem.Trim();
        if (!text.StartsWith("CÄƒn cá»©") && !text.StartsWith("Theo"))
            text = "CÄƒn cá»© " + text;
        
        // Táº¡o paragraph vá»›i format Times 14pt, cÄƒn trÃ¡i
        // ...
    }
}
```

## Tham kháº£o vÄƒn báº£n máº«u

CÃ¡c vÄƒn báº£n máº«u tá»« thá»±c táº¿ Ä‘á»u cÃ³ pháº§n cÄƒn cá»©:

### VÃ­ dá»¥ 1: Luáº­t
```
QUá»C Há»˜I
---------
LUáº¬T
Sá»­a Ä‘á»•i, bá»• sung má»™t sá»‘ Ä‘iá»u cá»§a Luáº­t ABC

CÄƒn cá»© Hiáº¿n phÃ¡p nÆ°á»›c Cá»™ng hÃ²a xÃ£ há»™i chá»§ nghÄ©a Viá»‡t Nam;
Quá»‘c há»™i ban hÃ nh Luáº­t sá»­a Ä‘á»•i, bá»• sung...
```

### VÃ­ dá»¥ 2: Quyáº¿t Ä‘á»‹nh
```
CHá»¦ Tá»ŠCH á»¦Y BAN NHÃ‚N DÃ‚N Tá»ˆNH NGHá»† AN
----------------
QUYáº¾T Äá»ŠNH
Vá» viá»‡c phÃª duyá»‡t káº¿ hoáº¡ch...

CÄƒn cá»© Luáº­t Tá»• chá»©c chÃ­nh quyá»n Ä‘á»‹a phÆ°Æ¡ng ngÃ y 19/6/2015;
CÄƒn cá»© Nghá»‹ Ä‘á»‹nh sá»‘ 66/NQ-CP...;
Theo Ä‘á» nghá»‹ cá»§a GiÃ¡m Ä‘á»‘c Sá»Ÿ...;

QUYáº¾T Äá»ŠNH:
...
```

### VÃ­ dá»¥ 3: Nghá»‹ Ä‘á»‹nh
```
CHÃNH PHá»¦
---------
NGHá»Š Äá»ŠNH
Vá» quáº£n lÃ½, phÃ¡t triá»ƒn vÃ  sá»­ dá»¥ng...

CÄƒn cá»© Luáº­t Tá»• chá»©c ChÃ­nh phá»§...;
CÄƒn cá»© Luáº­t Quáº£n lÃ½, sá»­ dá»¥ng tÃ i sáº£n cÃ´ng...;
Theo Ä‘á» nghá»‹ cá»§a Bá»™ trÆ°á»Ÿng Bá»™...;

CHÃNH PHá»¦ NGHá»Š Äá»ŠNH:
...
```

## Lá»£i Ã­ch

âœ… **TuÃ¢n thá»§ chuáº©n**: ÄÃºng theo ThÃ´ng tÆ° 01/2011/TT-BNV cá»§a Bá»™ Ná»™i vá»¥
âœ… **HoÃ n chá»‰nh**: Bao gá»“m Ä‘áº§y Ä‘á»§ cÃ¡c pháº§n cá»§a vÄƒn báº£n hÃ nh chÃ­nh
âœ… **Dá»… sá»­ dá»¥ng**: UI thÃ¢n thiá»‡n vá»›i tooltip hÆ°á»›ng dáº«n
âœ… **Linh hoáº¡t**: Há»— trá»£ nhiá»u cÄƒn cá»©, tá»± Ä‘á»™ng format
âœ… **Nháº¥t quÃ¡n**: Äá»‹nh dáº¡ng giá»‘ng nhau giá»¯a single export vÃ  bulk export

## Ghi chÃº

- Pháº§n cÄƒn cá»© lÃ  **Báº®T BUá»˜C** trong háº§u háº¿t vÄƒn báº£n hÃ nh chÃ­nh VN
- Náº¿u khÃ´ng nháº­p cÄƒn cá»©, pháº§n nÃ y sáº½ khÃ´ng xuáº¥t hiá»‡n trong Word (tÆ°Æ¡ng tá»± trÆ°á»ng Subject)
- Há»‡ thá»‘ng tá»± Ä‘á»™ng thÃªm "CÄƒn cá»©" vÃ o Ä‘áº§u dÃ²ng náº¿u thiáº¿u
- Há»— trá»£ cáº£ "CÄƒn cá»©" vÃ  "Theo" (thÆ°á»ng dÃ¹ng cho Ä‘á» nghá»‹ cá»§a cÆ¡ quan cáº¥p dÆ°á»›i)

---

**NgÃ y táº¡o**: 2025-01-24
**PhiÃªn báº£n**: 1.0
**TÃ¡c giáº£**: GitHub Copilot + User
