<Window x:Class="AIVanBan.Desktop.Views.AlbumStructureSetupDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="âš™ï¸ Thiáº¿t láº­p cáº¥u trÃºc Album" 
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        FontFamily="{materialDesign:MaterialDesignFont}">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="âš™ï¸ THIáº¾T Láº¬P Cáº¤U TRÃšC ALBUM"
                      FontSize="24"
                      FontWeight="Bold"/>
            <TextBlock Text="Chá»n loáº¡i cÆ¡ quan Ä‘á»ƒ táº¡o cáº¥u trÃºc album phÃ¹ há»£p"
                      FontSize="14"
                      Foreground="{DynamicResource MaterialDesignBodyLight}"
                      Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left: Template Selection -->
            <materialDesign:Card Grid.Column="0" Margin="0,0,10,0" Padding="15">
                <StackPanel>
                    <TextBlock Text="ðŸ“‹ Chá»n loáº¡i cÆ¡ quan"
                              FontWeight="Bold"
                              FontSize="14"
                              Margin="0,0,0,15"/>

                    <ScrollViewer MaxHeight="400" VerticalScrollBarVisibility="Auto">
                        <ListView x:Name="lvTemplates"
                                 SelectionMode="Single"
                                 SelectionChanged="Templates_SelectionChanged"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 ScrollViewer.VerticalScrollBarVisibility="Disabled">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <materialDesign:PackIcon Grid.Column="0"
                                                                Kind="FolderMultiple"
                                                                Width="24"
                                                                Height="24"
                                                                Margin="0,0,10,0"
                                                                VerticalAlignment="Center"/>

                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="{Binding Name}" 
                                                      FontWeight="SemiBold"
                                                      TextWrapping="Wrap"/>
                                            <TextBlock Text="{Binding Description}"
                                                      FontSize="11"
                                                      Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                      TextWrapping="Wrap"/>
                                            <TextBlock FontSize="10"
                                                      Margin="0,3,0,0">
                                                <Run Text="v"/>
                                                <Run Text="{Binding Version}"/>
                                                <Run Text=" â€¢ "/>
                                                <Run Text="{Binding Source}"/>
                                            </TextBlock>
                                        </StackPanel>

                                        <materialDesign:PackIcon Grid.Column="2"
                                                                Kind="CheckCircle"
                                                                Width="20"
                                                                Height="20"
                                                                Foreground="Green"
                                                                VerticalAlignment="Center"
                                                                Visibility="{Binding IsActive, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </ScrollViewer>

                    <Separator Margin="0,15"/>

                    <Button x:Name="btnSyncFromWeb"
                           Style="{StaticResource MaterialDesignOutlinedButton}"
                           Content="ðŸŒ Äá»“ng bá»™ tá»« Web"
                           Click="SyncFromWeb_Click"
                           Margin="0,10,0,5"/>

                    <TextBlock Text="Táº£i cáº¥u trÃºc má»›i nháº¥t tá»« server"
                              FontSize="11"
                              Foreground="{DynamicResource MaterialDesignBodyLight}"
                              TextWrapping="Wrap"
                              Margin="5,0,0,0"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Right: Template Preview -->
            <materialDesign:Card Grid.Column="1" Padding="15">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Template Info -->
                    <StackPanel Grid.Row="0" Margin="0,0,0,15">
                        <TextBlock x:Name="txtTemplateName"
                                  Text="Xem trÆ°á»›c cáº¥u trÃºc"
                                  FontWeight="Bold"
                                  FontSize="16"/>
                        <TextBlock x:Name="txtTemplateDescription"
                                  Text="Chá»n template bÃªn trÃ¡i Ä‘á»ƒ xem chi tiáº¿t"
                                  Foreground="{DynamicResource MaterialDesignBodyLight}"
                                  Margin="0,5,0,0"
                                  TextWrapping="Wrap"/>
                        
                        <StackPanel x:Name="pnlTemplateStats"
                                   Orientation="Horizontal"
                                   Margin="0,10,0,0"
                                   Visibility="Collapsed">
                            <materialDesign:Chip Content="0 danh má»¥c"
                                                x:Name="chipCategories"
                                                Margin="0,0,5,0"/>
                            <materialDesign:Chip Content="0 phÃ¢n loáº¡i"
                                                x:Name="chipSubCategories"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Categories Tree -->
                    <ScrollViewer Grid.Row="1" 
                                 VerticalScrollBarVisibility="Auto"
                                 HorizontalScrollBarVisibility="Disabled">
                        <TreeView x:Name="tvStructurePreview"
                                 Background="Transparent">
                            <TreeView.ItemContainerStyle>
                                <Style TargetType="TreeViewItem" BasedOn="{StaticResource MaterialDesignTreeViewItem}">
                                    <Setter Property="IsExpanded" Value="True"/>
                                </Style>
                            </TreeView.ItemContainerStyle>
                        </TreeView>
                    </ScrollViewer>

                    <!-- Actions -->
                    <StackPanel Grid.Row="2" 
                               Orientation="Horizontal"
                               HorizontalAlignment="Right"
                               Margin="0,15,0,0">
                        <Button x:Name="btnCreateStructure"
                               Style="{StaticResource MaterialDesignRaisedButton}"
                               Content="âœ… Ãp dá»¥ng cáº¥u trÃºc nÃ y"
                               Click="CreateStructure_Click"
                               IsEnabled="False"
                               Margin="0,0,10,0"/>
                        <TextBlock VerticalAlignment="Center"
                                  Foreground="{DynamicResource MaterialDesignBodyLight}"
                                  FontSize="11"
                                  Text="(Sáº½ táº¡o folder vÃ  lÆ°u vÃ o database)"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
        </Grid>

        <!-- Footer -->
        <StackPanel Grid.Row="2" 
                   Orientation="Horizontal" 
                   HorizontalAlignment="Right"
                   Margin="0,20,0,0">
            <Button Content="ÄÃ“NG"
                   Style="{StaticResource MaterialDesignFlatButton}"
                   Click="Close_Click"/>
        </StackPanel>
    </Grid>
</Window>
