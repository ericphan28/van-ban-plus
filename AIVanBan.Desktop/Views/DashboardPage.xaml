<Page x:Class="AIVanBan.Desktop.Views.DashboardPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      xmlns:local="clr-namespace:AIVanBan.Desktop.Views"
      Title="Trang chá»§"
      Background="{DynamicResource MaterialDesignPaper}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel MaxWidth="1200" Margin="24,16,24,24">

            <!-- â•â•â• HEADER: Greeting + Date + Refresh â•â•â• -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock x:Name="txtGreeting" Text="ChÃ o buá»•i sÃ¡ng!" 
                              FontSize="26" FontWeight="Bold"
                              Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                    <TextBlock x:Name="txtDate" FontSize="14" Opacity="0.6" Margin="0,4,0,0"/>
                </StackPanel>
                <Button Grid.Column="1" Style="{StaticResource MaterialDesignOutlinedButton}"
                        Click="RefreshDashboard_Click" Height="36" VerticalAlignment="Top"
                        ToolTip="LÃ m má»›i dá»¯ liá»‡u">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Refresh" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBlock Text="LÃ m má»›i" FontSize="12"/>
                    </StackPanel>
                </Button>
            </Grid>

            <!-- â•â•â• ROW 1: STAT CARDS (5 cards) â•â•â• -->
            <UniformGrid Columns="5" Margin="0,0,0,20">
                <!-- Card 1: Tá»•ng VB -->
                <materialDesign:Card Margin="0,0,10,0" Padding="16" 
                                     materialDesign:ElevationAssist.Elevation="Dp2"
                                     ToolTip="ðŸ“ Theo dÃµi 29 loáº¡i VB hÃ nh chÃ­nh â€” Äiá»u 7, NÄ 30/2020">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#E3F2FD" CornerRadius="8" 
                                Width="44" Height="44" Margin="0,0,12,0">
                            <materialDesign:PackIcon Kind="FileDocumentMultiple" Width="24" Height="24"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="#1565C0"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Tá»”NG VÄ‚N Báº¢N" FontSize="10" FontWeight="SemiBold" 
                                      Opacity="0.5" Margin="0,0,0,2"/>
                            <TextBlock x:Name="txtStatTotal" Text="0" FontSize="24" FontWeight="Bold"
                                      Foreground="#1565C0"/>
                            <TextBlock x:Name="txtStatTotalDelta" Text="+0 tuáº§n nÃ y" FontSize="10.5" 
                                      Foreground="#4CAF50" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>

                <!-- Card 2: VB Äáº¿n -->
                <materialDesign:Card Margin="0,0,10,0" Padding="16" Cursor="Hand"
                                     materialDesign:ElevationAssist.Elevation="Dp2"
                                     MouseLeftButtonUp="StatCard_Documents_Click"
                                     ToolTip="ðŸ“ VÄƒn báº£n Ä‘áº¿n â€” Äiá»u 21-24, NÄ 30/2020">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#FFF3E0" CornerRadius="8" 
                                Width="44" Height="44" Margin="0,0,12,0">
                            <materialDesign:PackIcon Kind="EmailArrowLeft" Width="24" Height="24"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="#E65100"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="VB Äáº¾N (THÃNG)" FontSize="10" FontWeight="SemiBold" 
                                      Opacity="0.5" Margin="0,0,0,2"/>
                            <TextBlock x:Name="txtStatDen" Text="0" FontSize="24" FontWeight="Bold"
                                      Foreground="#E65100"/>
                            <TextBlock x:Name="txtStatDenDelta" Text="+0 tuáº§n nÃ y" FontSize="10.5" 
                                      Foreground="#4CAF50" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>

                <!-- Card 3: VB Äi -->
                <materialDesign:Card Margin="0,0,10,0" Padding="16" Cursor="Hand"
                                     materialDesign:ElevationAssist.Elevation="Dp2"
                                     MouseLeftButtonUp="StatCard_Documents_Click"
                                     ToolTip="ðŸ“ VÄƒn báº£n Ä‘i â€” Äiá»u 17-20, NÄ 30/2020">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#E8F5E9" CornerRadius="8" 
                                Width="44" Height="44" Margin="0,0,12,0">
                            <materialDesign:PackIcon Kind="EmailArrowRight" Width="24" Height="24"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="#2E7D32"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="VB ÄI (THÃNG)" FontSize="10" FontWeight="SemiBold" 
                                      Opacity="0.5" Margin="0,0,0,2"/>
                            <TextBlock x:Name="txtStatDi" Text="0" FontSize="24" FontWeight="Bold"
                                      Foreground="#2E7D32"/>
                            <TextBlock x:Name="txtStatDiDelta" Text="+0 tuáº§n nÃ y" FontSize="10.5" 
                                      Foreground="#4CAF50" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>

                <!-- Card 4: Ná»™i bá»™ -->
                <materialDesign:Card Margin="0,0,10,0" Padding="16" Cursor="Hand"
                                     materialDesign:ElevationAssist.Elevation="Dp2"
                                     MouseLeftButtonUp="StatCard_Documents_Click">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#F3E5F5" CornerRadius="8" 
                                Width="44" Height="44" Margin="0,0,12,0">
                            <materialDesign:PackIcon Kind="SwapHorizontal" Width="24" Height="24"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="#6A1B9A"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Ná»˜I Bá»˜ (THÃNG)" FontSize="10" FontWeight="SemiBold" 
                                      Opacity="0.5" Margin="0,0,0,2"/>
                            <TextBlock x:Name="txtStatNoiBo" Text="0" FontSize="24" FontWeight="Bold"
                                      Foreground="#6A1B9A"/>
                            <TextBlock x:Name="txtStatNoiBoDelta" Text="+0 tuáº§n nÃ y" FontSize="10.5" 
                                      Foreground="#4CAF50" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>

                <!-- Card 5: Há»p thÃ¡ng nÃ y -->
                <materialDesign:Card Padding="16" Cursor="Hand"
                                     materialDesign:ElevationAssist.Elevation="Dp2"
                                     MouseLeftButtonUp="StatCard_Meetings_Click">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#E0F2F1" CornerRadius="8" 
                                Width="44" Height="44" Margin="0,0,12,0">
                            <materialDesign:PackIcon Kind="CalendarMonth" Width="24" Height="24"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="#00796B"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Há»ŒP THÃNG NÃ€Y" FontSize="10" FontWeight="SemiBold" 
                                      Opacity="0.5" Margin="0,0,0,2"/>
                            <TextBlock x:Name="txtStatMeeting" Text="0" FontSize="24" FontWeight="Bold"
                                      Foreground="#00796B"/>
                            <TextBlock x:Name="txtStatMeetingDelta" Text="+0 tuáº§n nÃ y" FontSize="10.5" 
                                      Foreground="#4CAF50" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>
            </UniformGrid>

            <!-- â•â•â• ROW 2: Alerts + Today Schedule â•â•â• -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Alerts Panel -->
                <materialDesign:Card Grid.Column="0" Padding="0"
                                     materialDesign:ElevationAssist.Elevation="Dp1">
                    <StackPanel>
                        <Border Background="#FFF8E1" Padding="14,10" CornerRadius="4,4,0,0"
                                Cursor="Hand" MouseLeftButtonUp="LinkToDocuments_Click">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <materialDesign:PackIcon Kind="AlertCircleOutline" Width="20" Height="20" 
                                                            Foreground="#F57F17" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="Cáº¦N Xá»¬ LÃ" FontSize="13" FontWeight="Bold" 
                                              Foreground="#F57F17" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="Xem vÄƒn báº£n â†’" FontSize="11" Foreground="#F57F17" 
                                          HorizontalAlignment="Right" VerticalAlignment="Center"
                                          Opacity="0.7"/>
                            </Grid>
                        </Border>
                        <ItemsControl x:Name="alertList" Padding="8,4,8,8">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,4" Padding="10,8" CornerRadius="6"
                                            Background="{Binding Background}" BorderThickness="0,0,0,0">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="16" 
                                                      VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <TextBlock Grid.Column="1" Text="{Binding Message}" FontSize="13" 
                                                      VerticalAlignment="Center" TextWrapping="Wrap"/>
                                            <TextBlock Grid.Column="2" Text="{Binding Badge}" FontSize="12" 
                                                      FontWeight="Bold" Foreground="{Binding BadgeColor}"
                                                      VerticalAlignment="Center" Margin="8,0,0,0"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <!-- Empty state for alerts -->
                        <StackPanel x:Name="pnlNoAlerts" Visibility="Collapsed" 
                                   HorizontalAlignment="Center" Margin="0,16,0,20">
                            <materialDesign:PackIcon Kind="CheckCircleOutline" Width="36" Height="36"
                                                    HorizontalAlignment="Center" Foreground="#4CAF50"/>
                            <TextBlock Text="KhÃ´ng cÃ³ viá»‡c gáº¥p â€” Tuyá»‡t vá»i!" FontSize="13" 
                                      Opacity="0.6" Margin="0,6,0,0" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Upcoming Schedule (7 ngÃ y tá»›i) -->
                <materialDesign:Card Grid.Column="2" Padding="0"
                                     materialDesign:ElevationAssist.Elevation="Dp1">
                    <StackPanel>
                        <Border Background="#E3F2FD" Padding="14,10" CornerRadius="4,4,0,0"
                                Cursor="Hand" MouseLeftButtonUp="LinkToMeetings_Click">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <materialDesign:PackIcon Kind="CalendarMonth" Width="20" Height="20" 
                                                            Foreground="#1565C0" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="Lá»ŠCH Há»ŒP Sáº®P Tá»šI" FontSize="13" FontWeight="Bold" 
                                              Foreground="#1565C0" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtScheduleCount" FontSize="12" Foreground="#1976D2"
                                              VerticalAlignment="Center" Margin="6,0,0,0" Opacity="0.7"/>
                                </StackPanel>
                                <TextBlock Text="Xem lá»‹ch há»p â†’" FontSize="11" Foreground="#1565C0" 
                                          HorizontalAlignment="Right" VerticalAlignment="Center"
                                          Opacity="0.7"/>
                            </Grid>
                        </Border>

                        <ScrollViewer MaxHeight="340" VerticalScrollBarVisibility="Auto" Padding="0">
                            <ItemsControl x:Name="scheduleList" Padding="10,4,10,8">
                                <ItemsControl.Resources>
                                    <!-- Day Header Template -->
                                    <DataTemplate x:Key="DayHeaderTemplate">
                                        <Border Margin="0,8,0,2" Padding="8,5" CornerRadius="4"
                                                Background="#E8EAF6">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon Kind="CalendarToday" Width="15" Height="15"
                                                                            Foreground="#283593" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                                    <TextBlock Text="{Binding DayLabel}" FontSize="12" FontWeight="Bold"
                                                              Foreground="#283593" VerticalAlignment="Center"/>
                                                    <TextBlock Text="{Binding DateText}" FontSize="11" 
                                                              Foreground="#5C6BC0" VerticalAlignment="Center" Margin="8,0,0,0"
                                                              Opacity="0.8"/>
                                                </StackPanel>
                                                <TextBlock Grid.Column="1" FontSize="11" Foreground="#3949AB"
                                                          VerticalAlignment="Center">
                                                    <Run Text="{Binding MeetingCount, Mode=OneWay}"/>
                                                    <Run Text=" cuá»™c"/>
                                                </TextBlock>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>

                                    <!-- Meeting Item Template -->
                                    <DataTemplate x:Key="MeetingItemTemplate">
                                        <Border Margin="0,3" Padding="0" CornerRadius="6" Background="#FAFAFA"
                                                BorderBrush="#E0E0E0" BorderThickness="0.5">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="4"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- Priority color bar (left) -->
                                                <Border Grid.Column="0" Background="{Binding PriorityBrush}" 
                                                        CornerRadius="6,0,0,6" Width="4"/>
                                                
                                                <!-- Meeting details -->
                                                <StackPanel Grid.Column="1" Margin="10,7,8,7">
                                                    <!-- Row 1: Time + Title + Status -->
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="{Binding Time}" FontSize="12.5" 
                                                                  FontWeight="Bold" Foreground="#1565C0"
                                                                  VerticalAlignment="Center" Margin="0,0,10,0"
                                                                  MinWidth="42"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding Title}" FontSize="12.5"
                                                                  FontWeight="SemiBold" VerticalAlignment="Center" 
                                                                  TextTrimming="CharacterEllipsis"/>
                                                        <Border Grid.Column="2" Background="{Binding StatusBrush}" 
                                                                CornerRadius="3" Padding="6,2" Margin="6,0,0,0"
                                                                VerticalAlignment="Center">
                                                            <TextBlock Text="{Binding StatusText}" FontSize="10" 
                                                                      Foreground="White" FontWeight="SemiBold"/>
                                                        </Border>
                                                    </Grid>
                                                    
                                                    <!-- Row 2: Location + ChairPerson + Format -->
                                                    <WrapPanel Margin="0,4,0,0">
                                                        <!-- Location -->
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,12,0"
                                                                    Visibility="{Binding LocationVisible}">
                                                            <materialDesign:PackIcon Kind="MapMarker" Width="13" Height="13"
                                                                                    Foreground="#757575" VerticalAlignment="Center" Margin="0,0,3,0"/>
                                                            <TextBlock Text="{Binding Location}" FontSize="11" 
                                                                      Foreground="#616161" VerticalAlignment="Center"
                                                                      MaxWidth="160" TextTrimming="CharacterEllipsis"/>
                                                        </StackPanel>
                                                        
                                                        <!-- Chair person -->
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,12,0"
                                                                    Visibility="{Binding ChairVisible}">
                                                            <materialDesign:PackIcon Kind="AccountTie" Width="13" Height="13"
                                                                                    Foreground="#757575" VerticalAlignment="Center" Margin="0,0,3,0"/>
                                                            <TextBlock FontSize="11" Foreground="#616161" VerticalAlignment="Center">
                                                                <Run Text="CT: "/><Run Text="{Binding ChairPerson, Mode=OneWay}" FontWeight="SemiBold"/>
                                                            </TextBlock>
                                                        </StackPanel>

                                                        <!-- Format badge -->
                                                        <Border Background="{Binding FormatBg}" CornerRadius="3" 
                                                                Padding="5,1" Margin="0,0,6,0" VerticalAlignment="Center">
                                                            <TextBlock Text="{Binding FormatText}" FontSize="10" 
                                                                      Foreground="{Binding FormatFg}"/>
                                                        </Border>

                                                        <!-- Task count -->
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,6,0"
                                                                    Visibility="{Binding TaskVisible}">
                                                            <materialDesign:PackIcon Kind="ClipboardCheck" Width="13" Height="13"
                                                                                    Foreground="#EF6C00" VerticalAlignment="Center" Margin="0,0,2,0"/>
                                                            <TextBlock FontSize="10.5" Foreground="#EF6C00" VerticalAlignment="Center">
                                                                <Run Text="{Binding TaskCount, Mode=OneWay}"/>
                                                                <Run Text=" nhiá»‡m vá»¥"/>
                                                            </TextBlock>
                                                        </StackPanel>
                                                    </WrapPanel>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.Resources>

                                <ItemsControl.ItemTemplateSelector>
                                    <local:ScheduleTemplateSelector
                                        DayHeaderTemplate="{StaticResource DayHeaderTemplate}"
                                        MeetingItemTemplate="{StaticResource MeetingItemTemplate}"/>
                                </ItemsControl.ItemTemplateSelector>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Empty state for schedule -->
                        <StackPanel x:Name="pnlNoSchedule" Visibility="Collapsed"
                                   HorizontalAlignment="Center" Margin="0,20,0,24">
                            <materialDesign:PackIcon Kind="CalendarCheck" Width="36" Height="36"
                                                    HorizontalAlignment="Center" Foreground="#4CAF50" Opacity="0.6"/>
                            <TextBlock Text="KhÃ´ng cÃ³ lá»‹ch há»p trong 7 ngÃ y tá»›i" FontSize="13" 
                                      Opacity="0.5" Margin="0,6,0,0" HorizontalAlignment="Center"/>
                            <TextBlock Text="Lá»‹ch trá»‘ng â€” Thá»i gian tá»‘t Ä‘á»ƒ xá»­ lÃ½ há»“ sÆ¡ ðŸ“‹" FontSize="11" 
                                      Opacity="0.4" Margin="0,4,0,0" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>
            </Grid>

            <!-- â•â•â• ROW 3: Doc by Type Chart + Recent Activity â•â•â• -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- VB Theo Loáº¡i (thÃ¡ng nÃ y) -->
                <materialDesign:Card Grid.Column="0" Padding="0"
                                     materialDesign:ElevationAssist.Elevation="Dp1">
                    <StackPanel>
                        <Border Background="#F5F5F5" Padding="14,10" CornerRadius="4,4,0,0"
                                Cursor="Hand" MouseLeftButtonUp="LinkToDocuments_Click">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <materialDesign:PackIcon Kind="ChartBar" Width="20" Height="20" 
                                                            Foreground="#455A64" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="VÄ‚N Báº¢N THEO LOáº I (THÃNG NÃ€Y)" FontSize="12" FontWeight="Bold" 
                                              Foreground="#455A64" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="Xem danh sÃ¡ch â†’" FontSize="11" Foreground="#1565C0" 
                                          HorizontalAlignment="Right" VerticalAlignment="Center"
                                          Opacity="0.7"/>
                            </Grid>
                        </Border>
                        <ItemsControl x:Name="chartByType" Padding="16,8,16,12">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="90"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="36"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="{Binding TypeName}" FontSize="12.5" 
                                                  VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                        <Border Grid.Column="1" Height="18" CornerRadius="3" Margin="8,0"
                                                HorizontalAlignment="Left"
                                                Width="{Binding BarWidth}" Background="{Binding BarColor}"/>
                                        <TextBlock Grid.Column="2" Text="{Binding Count}" FontSize="12.5" 
                                                  FontWeight="Bold" VerticalAlignment="Center" 
                                                  HorizontalAlignment="Right" Foreground="#455A64"/>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <StackPanel x:Name="pnlNoDocTypes" Visibility="Collapsed"
                                   HorizontalAlignment="Center" Margin="0,16,0,24">
                            <TextBlock Text="ChÆ°a cÃ³ vÄƒn báº£n trong thÃ¡ng nÃ y" FontSize="13" Opacity="0.5"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Hoáº¡t Ä‘á»™ng gáº§n Ä‘Ã¢y -->
                <materialDesign:Card Grid.Column="2" Padding="0"
                                     materialDesign:ElevationAssist.Elevation="Dp1">
                    <StackPanel>
                        <Border Background="#F5F5F5" Padding="14,10" CornerRadius="4,4,0,0"
                                Cursor="Hand" MouseLeftButtonUp="LinkToDocuments_Click">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <materialDesign:PackIcon Kind="ClockOutline" Width="20" Height="20" 
                                                            Foreground="#455A64" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="HOáº T Äá»˜NG Gáº¦N ÄÃ‚Y" FontSize="12" FontWeight="Bold" 
                                              Foreground="#455A64" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="Xem táº¥t cáº£ â†’" FontSize="11" Foreground="#1565C0" 
                                          HorizontalAlignment="Right" VerticalAlignment="Center"
                                          Opacity="0.7"/>
                            </Grid>
                        </Border>
                        <ItemsControl x:Name="recentActivityList" Padding="12,4,12,8">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,3" Padding="8,6" CornerRadius="4">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Grid.Column="0" Width="28" Height="28" CornerRadius="14"
                                                    Background="{Binding IconBg}" Margin="0,0,10,0">
                                                <materialDesign:PackIcon Kind="{Binding IconKind}" Width="16" Height="16"
                                                                        HorizontalAlignment="Center" VerticalAlignment="Center"
                                                                        Foreground="{Binding IconFg}"/>
                                            </Border>
                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="{Binding Title}" FontSize="12.5" 
                                                          TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Text="{Binding TimeAgo}" FontSize="10.5" Opacity="0.5"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <StackPanel x:Name="pnlNoActivity" Visibility="Collapsed"
                                   HorizontalAlignment="Center" Margin="0,16,0,24">
                            <TextBlock Text="ChÆ°a cÃ³ hoáº¡t Ä‘á»™ng nÃ o" FontSize="13" Opacity="0.5"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>
            </Grid>

            <!-- â•â•â• ROW 4: Tasks + Quick Actions + Templates â•â•â• -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="280"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="280"/>
                </Grid.ColumnDefinitions>

                <!-- Nhiá»‡m vá»¥ cáº§n hoÃ n thÃ nh -->
                <materialDesign:Card Grid.Column="0" Padding="0"
                                     materialDesign:ElevationAssist.Elevation="Dp1">
                    <StackPanel>
                        <Border Background="#FBE9E7" Padding="14,10" CornerRadius="4,4,0,0"
                                Cursor="Hand" MouseLeftButtonUp="LinkToMeetings_Click">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <materialDesign:PackIcon Kind="ClipboardListOutline" Width="20" Height="20" 
                                                            Foreground="#BF360C" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="NHIá»†M Vá»¤ Cáº¦N LÃ€M" FontSize="12" FontWeight="Bold" 
                                              Foreground="#BF360C" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="Xem cuá»™c há»p â†’" FontSize="11" Foreground="#BF360C" 
                                          HorizontalAlignment="Right" VerticalAlignment="Center"
                                          Opacity="0.7"/>
                            </Grid>
                        </Border>
                        <ItemsControl x:Name="taskList" Padding="12,4,12,8">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,3" Padding="8,6" CornerRadius="4"
                                            Background="{Binding Background}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <materialDesign:PackIcon Grid.Column="0" Kind="{Binding StatusIcon}" 
                                                                    Width="18" Height="18" Margin="0,0,8,0"
                                                                    Foreground="{Binding StatusColor}" VerticalAlignment="Center"/>
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding Title}" FontSize="12.5" 
                                                          TextTrimming="CharacterEllipsis"
                                                          TextDecorations="{Binding Strikethrough}"/>
                                                <TextBlock Text="{Binding DeadlineText}" FontSize="10.5" 
                                                          Foreground="{Binding DeadlineColor}"/>
                                            </StackPanel>
                                            <TextBlock Grid.Column="2" Text="{Binding MeetingLabel}" 
                                                      FontSize="10" Opacity="0.5" VerticalAlignment="Center"
                                                      Margin="6,0,0,0"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <StackPanel x:Name="pnlNoTasks" Visibility="Collapsed"
                                   HorizontalAlignment="Center" Margin="0,16,0,24">
                            <materialDesign:PackIcon Kind="CheckAll" Width="32" Height="32"
                                                    HorizontalAlignment="Center" Foreground="#4CAF50" Opacity="0.6"/>
                            <TextBlock Text="HoÃ n thÃ nh táº¥t cáº£!" FontSize="13" Opacity="0.5" Margin="0,4,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Thao tÃ¡c nhanh -->
                <materialDesign:Card Grid.Column="2" Padding="0"
                                     materialDesign:ElevationAssist.Elevation="Dp1">
                    <StackPanel>
                        <Border Background="#E8EAF6" Padding="14,10" CornerRadius="4,4,0,0">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="RocketLaunchOutline" Width="20" Height="20" 
                                                        Foreground="#283593" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="THAO TÃC NHANH" FontSize="12" FontWeight="Bold" 
                                          Foreground="#283593" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <StackPanel Margin="12,8">
                            <Button Style="{StaticResource MaterialDesignOutlinedButton}" 
                                   HorizontalContentAlignment="Left" Margin="0,3" Padding="10,6"
                                   Height="Auto" Click="QuickAddDocument_Click">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Plus" Width="18" Height="18" 
                                                            VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="ThÃªm vÄƒn báº£n" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Style="{StaticResource MaterialDesignOutlinedButton}" 
                                   HorizontalContentAlignment="Left" Margin="0,3" Padding="10,6"
                                   Height="Auto" Click="QuickAICreate_Click">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Creation" Width="18" Height="18" 
                                                            VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="Táº¡o VB báº±ng AI" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Style="{StaticResource MaterialDesignOutlinedButton}" 
                                   HorizontalContentAlignment="Left" Margin="0,3" Padding="10,6"
                                   Height="Auto" Click="QuickScanOCR_Click">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Scanner" Width="18" Height="18" 
                                                            VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="Scan OCR" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Style="{StaticResource MaterialDesignOutlinedButton}" 
                                   HorizontalContentAlignment="Left" Margin="0,3" Padding="10,6"
                                   Height="Auto" Click="QuickAIReport_Click">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="ChartBar" Width="18" Height="18" 
                                                            VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="Táº¡o bÃ¡o cÃ¡o AI" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Style="{StaticResource MaterialDesignOutlinedButton}" 
                                   HorizontalContentAlignment="Left" Margin="0,3" Padding="10,6"
                                   Height="Auto" Click="QuickAddMeeting_Click">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="CalendarPlus" Width="18" Height="18" 
                                                            VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="ThÃªm cuá»™c há»p" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Máº«u VB hay dÃ¹ng -->
                <materialDesign:Card Grid.Column="4" Padding="0"
                                     materialDesign:ElevationAssist.Elevation="Dp1">
                    <StackPanel>
                        <Border Background="#E8F5E9" Padding="14,10" CornerRadius="4,4,0,0"
                                Cursor="Hand" MouseLeftButtonUp="LinkToTemplates_Click">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <materialDesign:PackIcon Kind="FileDocumentEdit" Width="20" Height="20" 
                                                            Foreground="#2E7D32" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="MáºªU HAY DÃ™NG" FontSize="12" FontWeight="Bold" 
                                              Foreground="#2E7D32" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="Quáº£n lÃ½ máº«u â†’" FontSize="11" Foreground="#2E7D32" 
                                          HorizontalAlignment="Right" VerticalAlignment="Center"
                                          Opacity="0.7"/>
                            </Grid>
                        </Border>
                        <ItemsControl x:Name="templateList" Padding="12,4,12,8">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,3" Padding="8,6" CornerRadius="4" Background="#FAFAFA"
                                            Cursor="Hand" MouseLeftButtonUp="Template_Click">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{Binding Name}" FontSize="12.5"
                                                      TextTrimming="CharacterEllipsis" VerticalAlignment="Center"/>
                                            <Border Grid.Column="1" Background="#E8F5E9" CornerRadius="10" 
                                                    Padding="6,2" Margin="6,0,0,0">
                                                <TextBlock Text="{Binding UsageText}" FontSize="10" 
                                                          Foreground="#2E7D32" FontWeight="SemiBold"/>
                                            </Border>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <StackPanel x:Name="pnlNoTemplates" Visibility="Collapsed"
                                   HorizontalAlignment="Center" Margin="0,10,0,16">
                            <TextBlock Text="ChÆ°a cÃ³ máº«u nÃ o" FontSize="12" Opacity="0.5"/>
                            <Button Style="{StaticResource MaterialDesignFlatButton}" FontSize="11" 
                                   Content="Táº£i máº«u tá»« kho" Click="QuickTemplateStore_Click"
                                   HorizontalAlignment="Center" Margin="0,4,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>
            </Grid>

            <!-- â•â•â• ROW 5: 6-month Trend Chart â•â•â• -->
            <materialDesign:Card Padding="0" Margin="0,0,0,10"
                                 materialDesign:ElevationAssist.Elevation="Dp1">
                <StackPanel>
                    <Border Background="#F5F5F5" Padding="14,10" CornerRadius="4,4,0,0"
                            Cursor="Hand" MouseLeftButtonUp="LinkToStatistics_Click">
                        <Grid>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                <materialDesign:PackIcon Kind="TrendingUp" Width="20" Height="20" 
                                                        Foreground="#455A64" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="XU HÆ¯á»šNG 6 THÃNG Gáº¦N NHáº¤T" FontSize="12" FontWeight="Bold" 
                                          Foreground="#455A64" VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock Text="Xem thá»‘ng kÃª â†’" FontSize="11" Foreground="#1565C0" 
                                      HorizontalAlignment="Right" VerticalAlignment="Center"
                                      Opacity="0.7"/>
                        </Grid>
                    </Border>
                    <Grid Margin="20,12,20,16" Height="160">
                        <!-- Y-axis labels -->
                        <Canvas x:Name="trendCanvas" ClipToBounds="False"/>
                    </Grid>
                    <!-- Legend -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,12">
                        <Border Background="#1565C0" Width="12" Height="12" CornerRadius="2" Margin="0,0,6,0"/>
                        <TextBlock Text="VB Äáº¿n" FontSize="11" Opacity="0.7" Margin="0,0,20,0"/>
                        <Border Background="#4CAF50" Width="12" Height="12" CornerRadius="2" Margin="0,0,6,0"/>
                        <TextBlock Text="VB Äi" FontSize="11" Opacity="0.7" Margin="0,0,20,0"/>
                        <Border Background="#9C27B0" Width="12" Height="12" CornerRadius="2" Margin="0,0,6,0"/>
                        <TextBlock Text="Ná»™i bá»™" FontSize="11" Opacity="0.7"/>
                    </StackPanel>
                </StackPanel>
            </materialDesign:Card>

            <!-- Footer Branding -->
            <TextBlock Text="VanBanPlus â€” Sáº£n pháº©m cá»§a CÃ´ng ty TNHH Gia Kiá»‡m Sá»‘ Â· giakiemso.com" 
                      FontSize="11" Opacity="0.4" HorizontalAlignment="Center" Margin="0,8,0,0"/>

        </StackPanel>
    </ScrollViewer>
</Page>
