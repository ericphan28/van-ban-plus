<Window x:Class="AIVanBan.Desktop.Views.AlbumDownloadDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Táº£i Album áº£nh tá»« Website xÃ£ Gia Kiá»‡m"
        Width="900" Height="680"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        FontFamily="{materialDesign:MaterialDesignFont}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Header -->
            <RowDefinition Height="Auto"/>   <!-- URL config -->
            <RowDefinition Height="Auto"/>   <!-- Search & filter -->
            <RowDefinition Height="Auto"/>   <!-- Stats & selection info -->
            <RowDefinition Height="*"/>      <!-- Album list -->
            <RowDefinition Height="Auto"/>   <!-- Pagination -->
            <RowDefinition Height="Auto"/>   <!-- Progress bar -->
            <RowDefinition Height="Auto"/>   <!-- Buttons -->
            <!-- Total: 8 rows (0-7) -->
        </Grid.RowDefinitions>

        <!-- Row 0: Header -->
        <Border Grid.Row="0" Background="#1565C0" Padding="16,12">
            <DockPanel>
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="CloudDownload" Width="26" Height="26" 
                                            Foreground="White" VerticalAlignment="Center"/>
                    <StackPanel Margin="10,0,0,0">
                        <TextBlock Text="Táº¢I ALBUM áº¢NH Tá»ª WEBSITE" FontSize="16" FontWeight="Bold" 
                                   Foreground="White"/>
                        <TextBlock Text="https://xagiakiem.gov.vn â€” Album áº£nh cÃ´ng khai" 
                                   FontSize="11" Foreground="#B3E5FC"/>
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right"
                            VerticalAlignment="Center">
                    <Button x:Name="btnSettings" Style="{StaticResource MaterialDesignIconButton}"
                            Click="ToggleUrlConfig_Click" ToolTip="Äá»•i server URL (dÃ nh cho testing)"
                            Width="30" Height="30" Margin="0,0,8,0">
                        <materialDesign:PackIcon Kind="Cog" Width="18" Height="18" Foreground="#B3E5FC"/>
                    </Button>
                    <materialDesign:PackIcon x:Name="iconConnection" Kind="CloudCheck" Width="18" Height="18" 
                                            Foreground="#81C784" VerticalAlignment="Center"/>
                    <TextBlock x:Name="txtConnectionStatus" Text="Äang káº¿t ná»‘i..." FontSize="11" 
                               Foreground="#B3E5FC" Margin="6,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Row 1: URL Config (collapsible) -->
        <Border x:Name="urlConfigPanel" Grid.Row="1" Background="#FFF3E0" Padding="12,8" 
                BorderBrush="#FFE0B2" BorderThickness="0,0,0,1" Visibility="Collapsed">
            <DockPanel>
                <TextBlock Text="ðŸ”— Server URL:" FontSize="12" VerticalAlignment="Center" 
                           Margin="0,0,8,0" FontWeight="SemiBold"/>
                <Button DockPanel.Dock="Right" Style="{StaticResource MaterialDesignRaisedButton}"
                        Click="ReconnectServer_Click" Padding="10,4" Margin="8,0,0,0"
                        Background="#FF9800" BorderBrush="#FF9800" Foreground="White" FontSize="11">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Refresh" Width="16" Height="16" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="Káº¿t ná»‘i láº¡i" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                <TextBox x:Name="txtServerUrl" Text="https://xagiakiem.gov.vn" 
                         materialDesign:HintAssist.Hint="URL server (VD: http://localhost:3550)"
                         materialDesign:HintAssist.IsFloating="False"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Padding="6,4" FontSize="12"/>
            </DockPanel>
        </Border>

        <!-- Row 2: Search -->
        <Border Grid.Row="2" Background="{DynamicResource MaterialDesignCardBackground}" 
                Padding="16,10" BorderBrush="{DynamicResource MaterialDesignDivider}" 
                BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBox x:Name="txtSearch" Grid.Column="0"
                         materialDesign:HintAssist.Hint="ðŸ” TÃ¬m kiáº¿m album trÃªn website..."
                         materialDesign:HintAssist.IsFloating="False"
                         materialDesign:TextFieldAssist.HasClearButton="True"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Padding="8,6" KeyDown="TxtSearch_KeyDown"/>
                
                <Button Grid.Column="1" Style="{StaticResource MaterialDesignRaisedButton}"
                        Margin="10,0,0,0" Click="SearchAlbums_Click" Padding="12,6">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Magnify" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="TÃ¬m" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- Row 3: Stats & selection -->
        <Border Grid.Row="3" Background="#E3F2FD" Padding="16,8"
                BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,0,0,1">
            <DockPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="txtTotalAlbums" Text="ðŸ“‹ 0 album cÃ´ng khai" FontSize="12.5" 
                               FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,20,0"/>
                    <TextBlock x:Name="txtPageInfo" Text="" FontSize="12" Foreground="#616161" 
                               VerticalAlignment="Center"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                    <materialDesign:PackIcon Kind="CheckboxMultipleMarked" Width="16" Height="16" 
                                            Foreground="#1565C0" VerticalAlignment="Center"/>
                    <TextBlock x:Name="txtSelectionInfo" Text="ChÆ°a chá»n album nÃ o" FontSize="12" 
                               Foreground="#1565C0" Margin="4,0,0,0" VerticalAlignment="Center"/>
                    <TextBlock Text="  (Tá»‘i Ä‘a 10)" FontSize="11" Foreground="#9E9E9E" 
                               VerticalAlignment="Center"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Row 4: Album list -->
        <Grid Grid.Row="4">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel x:Name="albumListPanel" Margin="12,8,12,8">
                    <!-- Album items added in code-behind -->
                </StackPanel>
            </ScrollViewer>
            
            <!-- Loading overlay -->
            <Border x:Name="loadingOverlay" Background="#80FFFFFF" Visibility="Visible">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Width="200" Margin="0,0,0,10"
                                 Style="{StaticResource MaterialDesignCircularProgressBar}"/>
                    <TextBlock x:Name="txtLoadingMessage" Text="Äang káº¿t ná»‘i server..." 
                               FontSize="13" Foreground="#616161" TextAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <!-- Empty state -->
            <StackPanel x:Name="emptyState" Visibility="Collapsed" 
                        VerticalAlignment="Center" HorizontalAlignment="Center">
                <materialDesign:PackIcon Kind="ImageOffOutline" Width="60" Height="60" 
                                        Foreground="#BDBDBD" HorizontalAlignment="Center"/>
                <TextBlock Text="KhÃ´ng tÃ¬m tháº¥y album nÃ o" FontSize="15" FontWeight="SemiBold"
                           Foreground="#757575" TextAlignment="Center" Margin="0,12,0,4"/>
                <TextBlock x:Name="txtEmptyHint" Text="Thá»­ thay Ä‘á»•i tá»« khÃ³a tÃ¬m kiáº¿m" FontSize="12" 
                           Foreground="#9E9E9E" TextAlignment="Center"/>
            </StackPanel>
        </Grid>

        <!-- Row 5: Pagination -->
        <Border Grid.Row="5" Padding="16,8" 
                BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,1,0,0">
            <DockPanel>
                <Button x:Name="btnPrevPage" Style="{StaticResource MaterialDesignOutlinedButton}"
                        Click="PrevPage_Click" Padding="10,4" IsEnabled="False" Margin="0,0,8,0">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="ChevronLeft" VerticalAlignment="Center"/>
                        <TextBlock Text="TrÆ°á»›c" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                <Button x:Name="btnNextPage" Style="{StaticResource MaterialDesignOutlinedButton}"
                        Click="NextPage_Click" Padding="10,4" IsEnabled="False" Margin="0,0,8,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Sau" VerticalAlignment="Center"/>
                        <materialDesign:PackIcon Kind="ChevronRight" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                
                <TextBlock x:Name="txtPaginationInfo" Text="" FontSize="12" Foreground="#757575" 
                           VerticalAlignment="Center" HorizontalAlignment="Right" DockPanel.Dock="Right"/>
            </DockPanel>
        </Border>

        <!-- Row 6: Progress bar (hidden by default) -->
        <Border x:Name="progressPanel" Grid.Row="6" Padding="16,10" Visibility="Collapsed"
                Background="#E8F5E9" BorderBrush="#A5D6A7" BorderThickness="0,1,0,0">
            <StackPanel>
                <DockPanel Margin="0,0,0,6">
                    <TextBlock x:Name="txtProgressTitle" Text="Äang táº£i album..." 
                               FontSize="13" FontWeight="SemiBold"/>
                    <TextBlock x:Name="txtProgressPercent" Text="0%" FontSize="13" FontWeight="SemiBold"
                               HorizontalAlignment="Right" DockPanel.Dock="Right"/>
                </DockPanel>
                <ProgressBar x:Name="downloadProgressBar" Height="8" Minimum="0" Maximum="100" Value="0"
                             Foreground="#43A047"/>
                <TextBlock x:Name="txtProgressDetail" Text="" FontSize="11" Foreground="#616161" 
                           Margin="0,4,0,0"/>
            </StackPanel>
        </Border>

        <!-- Row 7: Buttons -->
        <Border Grid.Row="7" Padding="16,12" Background="{DynamicResource MaterialDesignCardBackground}"
                BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,1,0,0">
            <DockPanel>
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="btnSelectAll" Style="{StaticResource MaterialDesignOutlinedButton}"
                            Click="SelectAll_Click" Padding="10,6">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="CheckboxMultipleMarked" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBlock Text="Chá»n trang nÃ y" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="btnDeselectAll" Style="{StaticResource MaterialDesignOutlinedButton}"
                            Click="DeselectAll_Click" Padding="10,6" Margin="8,0,0,0">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="CheckboxMultipleBlankOutline" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBlock Text="Bá» chá»n" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                    <Button x:Name="btnCancel" Style="{StaticResource MaterialDesignOutlinedButton}"
                            Click="Cancel_Click" Padding="16,6" IsCancel="True">
                        <TextBlock Text="ÄÃ³ng"/>
                    </Button>
                    <Button x:Name="btnDownload" Style="{StaticResource MaterialDesignRaisedButton}"
                            Click="Download_Click" Padding="16,6" Margin="10,0,0,0"
                            Background="#1565C0" BorderBrush="#1565C0" Foreground="White" IsEnabled="False">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="CloudDownload" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock x:Name="txtDownloadButton" Text="Táº£i album Ä‘Ã£ chá»n" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </DockPanel>
        </Border>
    </Grid>
</Window>
