<Window x:Class="AIVanBan.Desktop.Views.ApiSettingsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="âš™ï¸ CÃ i Ä‘áº·t API" Height="560" Width="520"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock Text="âš™ï¸ CÃ i Ä‘áº·t káº¿t ná»‘i AI" FontSize="20" FontWeight="Bold"
                       Foreground="{DynamicResource PrimaryHueMidBrush}"/>
            <TextBlock Text="Chá»n cháº¿ Ä‘á»™ gá»i AI vÃ  nháº­p thÃ´ng tin API Key" 
                       FontSize="13" Opacity="0.7" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Cháº¿ Ä‘á»™ API -->
                <GroupBox Header="Cháº¿ Ä‘á»™ API" Margin="0,0,0,12"
                          materialDesign:ColorZoneAssist.Mode="PrimaryLight">
                    <StackPanel Margin="8">
                        <RadioButton x:Name="rbVanBanPlus" Content="â˜ï¸ VanBanPlus API (khuyáº¿n nghá»‹)"
                                     FontWeight="SemiBold" Margin="0,4"
                                     Checked="ApiMode_Changed"/>
                        <TextBlock Text="   Gá»i AI qua server VanBanPlus â€” quáº£n lÃ½ quota, thá»‘ng kÃª sá»­ dá»¥ng" 
                                   FontSize="11" Opacity="0.6" Margin="0,0,0,8"/>
                        
                        <RadioButton x:Name="rbGeminiDirect" Content="ðŸ”‘ Gemini trá»±c tiáº¿p (legacy)"
                                     Margin="0,4"
                                     Checked="ApiMode_Changed"/>
                        <TextBlock Text="   Gá»i tháº³ng Google Gemini API báº±ng API Key cÃ¡ nhÃ¢n" 
                                   FontSize="11" Opacity="0.6"/>
                    </StackPanel>
                </GroupBox>

                <!-- VanBanPlus API Settings -->
                <GroupBox x:Name="grpVanBanPlus" Header="VanBanPlus API" Margin="0,0,0,12"
                          materialDesign:ColorZoneAssist.Mode="SecondaryLight">
                    <StackPanel Margin="8">
                        <TextBlock Text="API URL" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBox x:Name="txtApiUrl" 
                                 materialDesign:HintAssist.Hint="https://vanbanplus-api-xxx.vercel.app"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,0,12"/>

                        <TextBlock Text="API Key" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBox x:Name="txtApiKey"
                                 materialDesign:HintAssist.Hint="vbp_xxxxxxxxxxxx"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,0,12"/>

                        <Button Content="ðŸ” Kiá»ƒm tra káº¿t ná»‘i" Click="TestConnection_Click"
                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                HorizontalAlignment="Left" Margin="0,0,0,4"/>
                        <TextBlock x:Name="txtConnectionStatus" FontSize="12" Margin="0,4,0,0"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </GroupBox>

                <!-- Gemini Direct Settings -->
                <GroupBox x:Name="grpGeminiDirect" Header="Gemini API Key" Margin="0,0,0,12"
                          materialDesign:ColorZoneAssist.Mode="SecondaryLight">
                    <StackPanel Margin="8">
                        <TextBlock Text="Google Gemini API Key" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBox x:Name="txtGeminiKey"
                                 materialDesign:HintAssist.Hint="AIzaSy..."
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                        <TextBlock Text="Láº¥y API Key táº¡i: https://aistudio.google.com/apikey" 
                                   FontSize="11" Opacity="0.6" Margin="0,4,0,0"/>
                    </StackPanel>
                </GroupBox>

                <!-- Tráº¡ng thÃ¡i hiá»‡n táº¡i -->
                <Border Background="{DynamicResource MaterialDesignToolBarBackground}" 
                        CornerRadius="6" Padding="12" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ“Š Tráº¡ng thÃ¡i hiá»‡n táº¡i" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBlock x:Name="txtCurrentStatus" TextWrapping="Wrap" FontSize="12" Opacity="0.8"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button Content="ðŸ’¾ LÆ°u cÃ i Ä‘áº·t" Click="Save_Click"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Margin="0,0,8,0" MinWidth="120"/>
            <Button Content="Há»§y" Click="Cancel_Click"
                    Style="{StaticResource MaterialDesignOutlinedButton}"
                    MinWidth="80"/>
        </StackPanel>
    </Grid>
</Window>
