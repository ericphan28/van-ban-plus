<Window x:Class="AIVanBan.Desktop.Views.ApiSettingsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="‚öôÔ∏è C√†i ƒë·∫∑t k·∫øt n·ªëi AI" Height="580" Width="520"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header (click 5 l·∫ßn ƒë·ªÉ m·ªü ch·∫ø ƒë·ªô n√¢ng cao) -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16" MouseLeftButtonDown="Header_Click">
            <TextBlock Text="‚öôÔ∏è C√†i ƒë·∫∑t k·∫øt n·ªëi AI" FontSize="20" FontWeight="Bold"
                       Foreground="{DynamicResource PrimaryHueMidBrush}"/>
            <TextBlock Text="Nh·∫≠p th√¥ng tin k·∫øt n·ªëi ƒë·ªÉ s·ª≠ d·ª•ng t√≠nh nƒÉng AI" 
                       FontSize="13" Opacity="0.7" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Ch·∫ø ƒë·ªô k·∫øt n·ªëi (·∫©n, ch·ªâ dev th·∫•y) -->
                <GroupBox x:Name="grpModeSelector" Header="Ch·∫ø ƒë·ªô k·∫øt n·ªëi (N√¢ng cao)" Margin="0,0,0,12"
                          materialDesign:ColorZoneAssist.Mode="PrimaryLight"
                          Visibility="Collapsed">
                    <StackPanel Margin="8">
                        <RadioButton x:Name="rbVanBanPlus" Content="‚òÅÔ∏è VanBanPlus (khuy·∫øn ngh·ªã)"
                                     FontWeight="SemiBold" Margin="0,4"
                                     Checked="ApiMode_Changed"/>
                        <TextBlock Text="   K·∫øt n·ªëi AI qua h·ªá th·ªëng VanBanPlus" 
                                   FontSize="11" Opacity="0.6" Margin="0,0,0,8"/>
                        
                        <RadioButton x:Name="rbGeminiDirect" Content="üîß K·∫øt n·ªëi tr·ª±c ti·∫øp (B·∫£o tr√¨)"
                                     Margin="0,4"
                                     Checked="ApiMode_Changed"/>
                        <TextBlock Text="   Ch·ªâ d√†nh cho k·ªπ thu·∫≠t vi√™n b·∫£o tr√¨" 
                                   FontSize="11" Foreground="#D32F2F"/>
                        
                        <Button Content="üîí T·∫Øt ch·∫ø ƒë·ªô b·∫£o tr√¨" Click="CloseDevMode_Click"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                Foreground="#D32F2F" FontSize="11"
                                HorizontalAlignment="Right" Margin="0,8,0,0"/>
                    </StackPanel>
                </GroupBox>

                <!-- Th√¥ng tin k·∫øt n·ªëi VanBanPlus -->
                <GroupBox x:Name="grpVanBanPlus" Header="Th√¥ng tin k·∫øt n·ªëi" Margin="0,0,0,12"
                          materialDesign:ColorZoneAssist.Mode="SecondaryLight">
                    <StackPanel Margin="8">
                        <TextBlock Text="ƒê·ªãa ch·ªâ server" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBox x:Name="txtApiUrl" 
                                 materialDesign:HintAssist.Hint="https://vanbanplus-api-xxx.vercel.app"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,0,12"/>

                        <TextBlock Text="M√£ k√≠ch ho·∫°t" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBox x:Name="txtApiKey"
                                 materialDesign:HintAssist.Hint="vbp_xxxxxxxxxxxx"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,0,12"/>

                        <Button Content="üîç Ki·ªÉm tra k·∫øt n·ªëi" Click="TestConnection_Click"
                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                HorizontalAlignment="Left" Margin="0,0,0,4"/>
                        <TextBlock x:Name="txtConnectionStatus" FontSize="12" Margin="0,4,0,0"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </GroupBox>

                <!-- Dev mode: AI Direct (·∫©n m·∫∑c ƒë·ªãnh) -->
                <GroupBox x:Name="grpGeminiDirect" Header="üîß B·∫£o tr√¨ ‚Äî K·∫øt n·ªëi tr·ª±c ti·∫øp" Margin="0,0,0,12"
                          materialDesign:ColorZoneAssist.Mode="SecondaryLight"
                          Visibility="Collapsed">
                    <StackPanel Margin="8">
                        <TextBlock Text="M√£ k·∫øt n·ªëi AI tr·ª±c ti·∫øp" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBox x:Name="txtGeminiKey"
                                 materialDesign:HintAssist.Hint="Ch·ªâ k·ªπ thu·∫≠t vi√™n nh·∫≠p..."
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,0,8"/>
                        <TextBlock Text="‚ö†Ô∏è Ch·ªâ d√πng khi b·∫£o tr√¨. Kh√¥ng d√πng cho ho·∫°t ƒë·ªông h√†ng ng√†y." 
                                   FontSize="11" Foreground="#D32F2F" Margin="0,0,0,8"/>
                        
                        <Button Content="üîç Test API tr·ª±c ti·∫øp" Click="TestDirectConnection_Click"
                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                HorizontalAlignment="Left" Margin="0,0,0,4"/>
                        <TextBlock x:Name="txtDirectConnectionStatus" FontSize="12" Margin="0,4,0,0"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </GroupBox>

                <!-- Th√¥ng tin li√™n h·ªá + L·ª£i √≠ch AI -->
                <Border Background="#E3F2FD" CornerRadius="8" Padding="14" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock Text="üìû Li√™n h·ªá h·ªó tr·ª£" FontSize="14" FontWeight="Bold" 
                                   Foreground="#1565C0" Margin="0,0,0,8"/>
                        <TextBlock FontSize="13" Foreground="#333" Margin="0,0,0,4">
                            <Run FontWeight="SemiBold">Zalo: Th·∫Øng Phan ‚Äî 0907136029</Run>
                        </TextBlock>
                        <TextBlock Text="H·ªó tr·ª£ cung c·∫•p m√£ k√≠ch ho·∫°t, h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t, x·ª≠ l√Ω s·ª± c·ªë" 
                                   FontSize="11" Foreground="#666" Margin="0,0,0,10"/>
                        
                        <Border Background="White" CornerRadius="6" Padding="10">
                            <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="#333">
                                üí° AI gi√∫p b·∫°n: So·∫°n vƒÉn b·∫£n t·ª± ƒë·ªông ‚Ä¢ Ki·ªÉm tra ch√≠nh t·∫£ &amp; vƒÉn phong ‚Ä¢ Tr√≠ch xu·∫•t n·ªôi dung t·ª´ scan/PDF ‚Ä¢ ƒê·ªÅ xu·∫•t c·∫£i thi·ªán vƒÉn b·∫£n ‚Äî Ti·∫øt ki·ªám 70% th·ªùi gian x·ª≠ l√Ω c√¥ng vi·ªác!
                            </TextBlock>
                        </Border>
                        
                        <Border Background="#FFF3E0" CornerRadius="6" Padding="10" Margin="0,8,0,0">
                            <TextBlock TextWrapping="Wrap" FontSize="13" Foreground="#E65100" 
                                       FontWeight="SemiBold" TextAlignment="Center">
                                üí∞ Ch·ªâ t·ª´ 99.000ƒë/th√°ng ‚Äî ƒê·∫ßu t∆∞ nh·ªè, hi·ªáu qu·∫£ l·ªõn!
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Tr·∫°ng th√°i hi·ªán t·∫°i -->
                <Border Background="{DynamicResource MaterialDesignToolBarBackground}" 
                        CornerRadius="6" Padding="12" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="üìä Tr·∫°ng th√°i hi·ªán t·∫°i" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <TextBlock x:Name="txtCurrentStatus" TextWrapping="Wrap" FontSize="12" Opacity="0.8"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button Content="üíæ L∆∞u c√†i ƒë·∫∑t" Click="Save_Click"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Margin="0,0,8,0" MinWidth="120"/>
            <Button Content="H·ªßy" Click="Cancel_Click"
                    Style="{StaticResource MaterialDesignOutlinedButton}"
                    MinWidth="80"/>
        </StackPanel>
    </Grid>
</Window>
